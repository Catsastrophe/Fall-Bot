const Discord = require('discord.js');
const colors = require('./conf/colors.json');
const fs = require('fs');

module.exports = {
    async initCommands(client) {
        client.commands = new Discord.Collection();

        const commandFiles = (await fs.promises.readdir('./handlers/commands', { encoding: "utf-8" })).filter(file => file.endsWith('.js'));

        for (const file of commandFiles) {
            const command = require(`./handlers/commands/${file}`);
            try {
                client.commands.set(command.name, command);
            } catch (err) {
                console.error(err);
            }
        }
    },
    async execute_command(commandName, message, args, client) {

        const command = client.commands.get(commandName) ||
            client.commands.find(cmd => cmd.aliases && cmd.aliases.includes(commandName));

        if(!command) return;

        try {
            command.execute(message, args, client);
        } catch (error) {
            console.error(error);

            const embed = new Discord.MessageEmbed()
                .setTitle('A Problem Occured!')
                .setColor(colors.errorColor)
                .addField('Error:', error)

            message.channel.send(embed);
        }
    }
}





const { formatDate } = require("../../info");
const { MessageEmbed } = require("discord.js");
module.exports = {
  name: "youngest",
  category: "info",
  description: "Get the youngest account creation date in the guild!",
  run: async (message, bot, args) => {
    try {
    let mem = message.guild.members.cache
      .filter((m) => !m.user.bot)
      .sort((a, b) => b.user.createdAt - a.user.createdAt)
      .first();
    const Embed = new MessageEmbed()
      .setTitle(`The youngest member in ${message.guild.name}`)
      .setColor(`RANDOM`)
      .setFooter(`Date format: DD/MM/YYYY`)
      .setDescription(
        `${mem.user.tag} is the youngest user in ${
          message.guild.name
        }! \n\nAccount creation date: ${frmatDate(mem.user.createdAt)}`
      );
    message.channel.send(Embed);
  }

  catch (error) {
console.log(error);
message.reply(`Oh Nonono This is bad really Bad you got a error Please Dm **DarkerInk#6115** and Supply Him this error Below!! \n\nError: **${error}**`);
    }
  }
};




catch (error) {
            console.error(error);
            const ID = "814736327286194186";
            const channel = bot.channels.cache.get(ID);
            if (!channel) return;
            const embed = new Discord.MessageEmbed()
                .setTitle('A Problem Occured!')
                .setColor(colors.errorColor)
                .addField('Error:', error)

            channel.send(embed);